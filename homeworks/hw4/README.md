# CSCI-544 Homework 4 - NER (Named Entity Recognition)

## File Structure
```
The file structure is expected to be as follows:
- hw4
  - data
    - train
    - test
    - dev
    - glove.6B.100d
  - src 
    - dataset.py
    - glove.py
    - model.py
    - predict.py
    - train.py
    - vocab.py
  - task1.py
  - task2.py
  - eval.py
  - conll03eval.pl
  - README.md
```
Make sure to put `data` directory in the same directory as the code and include an unzipped `glove.6B.100d`. As it is too large to be uploaded, I have not included it in the submission.

The `output` directory and the files inside are generated by the code. It may not be present in the submission.
```
  (after running task1.py and task2.py)
  - output
    - vocab.txt
    - blstm1.pt
    - blstm2.pt
    - dev1.out
    - dev2.out
    - test1.out
    - test2.out
```
## Setup
### Change the Filename in `eval.py` and/or `conll03eval.pl`
In the provided files, the filenames in the last line of `eval.py` is not consistant with the Perl script. I have changed both to `conll03eval.pl`.
### Python Environment
The code is written in Python 3.10. The following packages are required:
- torch
- numpy
### Create Virtual Environment
To create a virtual environment, execute the following command:
```bash
python -m venv venv
```
### Install Required Packages
To install the required packages, execute the following command:
```bash
pip install -r requirements.txt
```
## Run Task1 and Task2
The scripts `task1.py` and `task2.py` are pipelines of:
1. Train a BiLSTM model for NER without (task1) / with (task2) GloVe embeddings, and save the model as `blstm1.pt` / `blstm2.pt`
2. Predict the NER tags on the **dev** data, output as `output/dev1.out` / `output/dev2.out`
3. Evaluate the predictions on the **dev** data
4. Predict the NER tags on the **test** data, output as `output/test1.out` / `output/test2.out`

To run the task1 and task2 scripts, execute the following commands:
```bash
python task1.py  # Task 1 - without GloVe embeddings
python task2.py  # Task 2 - with GloVe embeddings
```
## Configurate Hyperparameters
The hyperparameters can be configured in the `task1.py` and `task2.py` scripts. 

Change the numbers in this line:
```python
os.system("python src/train.py -t data/train -d data/dev --save_model_path out/blstm1.pt --epochs 25 --batch_size 32 --learning_rate 0.1")
```
Some other hyperparameters (e.g. `momentum`) can be configured directly in the `src/train.py` script.


